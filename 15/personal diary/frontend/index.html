<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–Ω–µ–≤–Ω–∏–∫ —ç–º–æ—Ü–∏–π</title>
    <link rel="icon" type="image/x-icon" href="cat.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìî –î–Ω–µ–≤–Ω–∏–∫ —ç–º–æ—Ü–∏–π</h1>
            <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π —Å–≤–æ–∏ —á—É–≤—Å—Ç–≤–∞ –∏ —Å–º–æ—Ç—Ä–∏, –∫–∞–∫ –æ–Ω–∏ –º–µ–Ω—è—é—Ç—Å—è</p>
        </header>

        <div id="successMsg" class="message success"></div>
        <div id="errorMsg" class="message error"></div>

        <div class="main-grid">
            <!-- Left: Entry Form -->
            <div class="card">
                <h2>üí≠ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º</h2>
                
                <div class="form-group">
                    <label for="entryText">–ö–∞–∫ –ø—Ä–æ—à–µ–ª —Ç–≤–æ–π –¥–µ–Ω—å? –û–ø–∏—à–∏ —Å–≤–æ–∏ —á—É–≤—Å—Ç–≤–∞:</label>
                    <textarea id="entryText" placeholder="–ü–∏—à–∏ —Å–≤–æ–±–æ–¥–Ω–æ, –±–µ–∑ —Å—Ç–µ—Å–Ω–µ–Ω–∏—è..."></textarea>
                </div>

                <button class="btn" id="analyzeBtn" onclick="analyzeEntry()">
                    <span id="analyzeText">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</span>
                </button>

                <div id="emotionResult" class="emotion-result">
                    <div style="font-size: 0.9em; color: var(--color-text-secondary); margin-bottom: var(--spacing-sm);">
                        –í–æ—Ç —á—Ç–æ —è –æ–ø—Ä–µ–¥–µ–ª–∏–ª:
                    </div>
                    <div class="emotion-large" id="resultEmoji"></div>
                    <div class="emotion-label" id="resultLabel"></div>
             
                    <!-- –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (AI –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π) -->
                    <div id="resultSource"
                         style="display:none; font-size: 0.8em; color: var(--color-text-secondary); margin-top: 4px;">
                    </div>

                    <div style="margin-top: var(--spacing-md); text-align: left;">
                        <div style="font-size: 0.85em; color: var(--color-text-secondary); margin-bottom: var(--spacing-sm);">
                            –í—ã–±–µ—Ä–∏ –Ω—É–∂–Ω—É—é —ç–º–æ—Ü–∏—é:
                        </div>
                        <div class="emotion-buttons" id="emotionButtons"></div>
                    </div>

                    <button class="btn" style="width: 100%; margin-top: var(--spacing-md);" onclick="saveEntry()">
                        ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å
                    </button>
                </div>

                <div id="entriesSection">
                    <h3 style="margin-top: var(--spacing-lg); font-size: 1.1em; color: var(--color-text-primary);">
                        üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏
                    </h3>
                    <div class="entries-list" id="entriesList"></div>
                </div>
            </div> 

            <!-- Right: Statistics & Chart -->
            <div class="card">
                <h2>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 30 –¥–Ω–µ–π</h2>

                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab('chart')">–ì—Ä–∞—Ñ–∏–∫</button>
                    <button class="tab-btn" onclick="switchTab('stats')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    <button class="tab-btn" onclick="switchTab('archive')">–ê—Ä—Ö–∏–≤</button>
                </div>

                <div id="chart" class="tab-content active">
                    <div class="chart-container">
                        <canvas id="emotionChart"></canvas>
                    </div>
                </div> 

                <div id="stats" class="tab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="totalEntries">0</div>
                            <div class="stat-label">–ó–∞–ø–∏—Å–µ–π</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="topEmotion">‚Äî</div>
                            <div class="stat-label">–ß–∞—Å—Ç–∞—è —ç–º–æ—Ü–∏—è</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="lastEntry">‚Äî</div>
                            <div class="stat-label">–ü–æ—Å–ª–µ–¥–Ω—è—è —ç–º–æ—Ü–∏—è</div>
                        </div>
                    </div>

                    <div style="margin-top: var(--spacing-lg);">
                        <h3 style="font-size: 1em; margin-bottom: var(--spacing-md);">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–º–æ—Ü–∏–π</h3>
                        <div id="emotionDistribution"></div>
                    </div>
                </div>

                <div id="archive" class="tab-content">
                    <div style="margin-bottom: var(--spacing-md);">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: var(--spacing-md); margin-bottom: var(--spacing-md);">
                            <div>
                                <label style="font-size: 0.9em;">–≠–º–æ—Ü–∏—è:</label>
                                <select id="emotionFilter" onchange="filterArchive()" style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--color-border); border-radius: var(--radius-base);">
                                    <option value="">–í—Å–µ —ç–º–æ—Ü–∏–∏</option>
                                    <option value="happiness">üòä –†–∞–¥–æ—Å—Ç—å</option>
                                    <option value="sadness">üò¢ –ì—Ä—É—Å—Ç—å</option>
                                    <option value="hatred">üò† –ù–µ–Ω–∞–≤–∏—Å—Ç—å</option>
                                    <option value="boredom">üòë –°–∫—É–∫–∞</option>
                                    <option value="love">‚ù§Ô∏è –õ—é–±–æ–≤—å</option>
                                    <option value="pleasure">üòã –£–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ</option>
                                    <option value="enthusiasm">üî• –≠–Ω—Ç—É–∑–∏–∞–∑–º</option>
                                    <option value="relief">üòå –û–±–ª–µ–≥—á–µ–Ω–∏–µ</option>
                                    <option value="surprise">üò≤ –£–¥–∏–≤–ª–µ–Ω–∏–µ</option>
                                    <option value="calmness">üòá –°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ</option>
                                    <option value="worry">üò∞ –ë–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ</option>
                                    <option value="emptiness">üåë –ü—É—Å—Ç–æ—Ç–∞</option>
                                    <option value="anger">üò° –ì–Ω–µ–≤</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.9em;">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                                <select id="sortFilter" onchange="filterArchive()" style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--color-border); border-radius: var(--radius-base);">
                                    <option value="newest">–ù–æ–≤—ã–µ –≤ –Ω–∞—á–∞–ª–µ</option>
                                    <option value="oldest">–°—Ç–∞—Ä—ã–µ –≤ –Ω–∞—á–∞–ª–µ</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size: 0.9em;">–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:</label>
                                <select id="perPageFilter" onchange="filterArchive()" style="width: 100%; padding: var(--spacing-sm); border: 1px solid var(--color-border); border-radius: var(--radius-base);">
                                    <option value="10">10 –∑–∞–ø–∏—Å–µ–π</option>
                                    <option value="20">20 –∑–∞–ø–∏—Å–µ–π</option>
                                    <option value="50">50 –∑–∞–ø–∏—Å–µ–π</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div id="archiveList" style="max-height: 500px; overflow-y: auto; margin-bottom: var(--spacing-md);"></div>

                    <div id="pagination" style="display: flex; gap: var(--spacing-sm); justify-content: center; flex-wrap: wrap;"></div>

                    <p id="archiveStats" style="text-align: center; color: var(--color-text-secondary); font-size: 0.9em; margin-top: var(--spacing-md);"></p>
                </div>

                <button class="btn btn-secondary" style="width: 100%; margin-top: var(--spacing-lg);" onclick="clearAllData()">
                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                </button>
            </div>
        </div>
    </div> 

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>
</html>
